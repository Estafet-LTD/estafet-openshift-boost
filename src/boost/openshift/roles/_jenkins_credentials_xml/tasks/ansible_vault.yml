---
- name: read ansible vault file and encode into base64
  set_fact:
    bytes: "{{lookup('file', '~/ansible_vault') | b64encode }}"

- debug:
    var: bytes
    verbosity: 0

- name: Set ansible vault password
  xml:
    path: "{{ roles }}/_jenkins_credentials_xml/files/credentials.xml"
    xpath: /com.cloudbees.plugins.credentials.SystemCredentialsProvider/domainCredentialsMap/entry/java.util.concurrent.CopyOnWriteArrayList/org.jenkinsci.plugins.plaincredentials.impl.FileCredentialsImpl/secretBytes
    value: "{{ bytes }}"