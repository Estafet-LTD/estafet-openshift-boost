apiVersion: v1
kind: Template
metadata:
  creationTimestamp: null
  name: global-pipelines
parameters:
- description: Defines the location of the estafet github (change this if you have forked and want to use another github)
  name: GITHUB
  required: true  
- description: Defines the host and port for the master node
  name: MASTER_HOST
  required: true  
- description: Defines the admin user
  name: ADMIN_USER
  required: true  
- description: Defines the admin password
  name: ADMIN_PASSWORD
  required: true    
- description: Defines the git repository uri within which the microservice resides
  name: REPO_URI
  required: true    
- description: Defines the product that this pipeline is related to
  name: PRODUCT
  required: true   
objects:              
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: create-environment
      product: ${PRODUCT}
    name: create-environment
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}
          - name: REPO
            value: ${REPO_URI}
          - name: PROJECT_TITLE
            value: "My Project"
          - name: MASTER_HOST
            value: ${MASTER_HOST}
          - name: ADMIN_USER
            value: ${ADMIN_USER}
          - name: ADMIN_PASSWORD
            value: ${ADMIN_PASSWORD}       
          - name: PRODUCT
            value: ${PRODUCT}   
          - name: USER_NAME
            value: "admin"                                   
          - name: USER_ID
            value: "1234"
        jenkinsfilePath: setup-environments/pipelines/create-environment.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0    
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: "build-boost-couchbase-lib"
    name: "build-boost-couchbase-lib"
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}                   
          - name: REPO
            value: estafet-openshift-boost-couchbase-lib            
        jenkinsfilePath: setup-environments/pipelines/build-library.jenkinsFile
      type: JenkinsPipeline
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0  
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: release-boost-couchbase-lib
    name: release-boost-couchbase-lib
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}             
          - name: REPO
            value: estafet-openshift-boost-couchbase-lib                       
        jenkinsfilePath: setup-environments/pipelines/release-library.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0    
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: "build-boost-messages-lib"
    name: "build-boost-messages-lib"
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}                   
          - name: REPO
            value: estafet-openshift-boost-messages-lib            
        jenkinsfilePath: setup-environments/pipelines/build-library.jenkinsFile
      type: JenkinsPipeline
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0  
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: release-boost-messages-lib
    name: release-boost-messages-lib
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}             
          - name: REPO
            value: estafet-openshift-boost-messages-lib                       
        jenkinsfilePath: setup-environments/pipelines/release-library.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: "build-boost-commons-lib"
    name: "build-boost-commons-lib"
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}                   
          - name: REPO
            value: estafet-openshift-boost-commons-lib            
        jenkinsfilePath: setup-environments/pipelines/build-library.jenkinsFile
      type: JenkinsPipeline
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0  
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: release-boost-commons-lib
    name: release-boost-commons-lib
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}             
          - name: REPO
            value: estafet-openshift-boost-commons-lib                       
        jenkinsfilePath: setup-environments/pipelines/release-library.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0         
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: "build-springboot"
    name: "build-springboot"
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}                   
          - name: REPO
            value: estafet-openshift-boost-springboot            
        jenkinsfilePath: setup-environments/pipelines/build-library.jenkinsFile
      type: JenkinsPipeline
    triggers:
    - github:
        secret: secret101
      type: GitHub
    - generic:
        secret: secret101
      type: Generic
  status:
    lastVersion: 0
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: release-springboot
    name: release-springboot
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: GITHUB
            value: ${GITHUB}             
          - name: REPO
            value: estafet-openshift-boost-springboot                       
        jenkinsfilePath: setup-environments/pipelines/release-library.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0           
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: build-all
      product: ${PRODUCT}
    name: build-all
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: PRODUCT
            value: ${PRODUCT}           
        jenkinsfilePath: setup-environments/pipelines/build-all.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0     
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: release-all
      product: ${PRODUCT}
    name: release-all
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: PRODUCT
            value: ${PRODUCT}        
        jenkinsfilePath: setup-environments/pipelines/release-all.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0    
- apiVersion: v1
  kind: BuildConfig
  metadata:
    creationTimestamp: null
    labels:
      app: pipeline
      name: promote-to-live
      product: ${PRODUCT}
    name: promote-to-live
  spec:
    output: {}
    postCommit: {}
    resources: {}
    runPolicy: Serial
    source:
      git:
        uri: "https://github.com/${GITHUB}/estafet-openshift-boost"
    strategy:
      jenkinsPipelineStrategy:
        env:
          - name: PRODUCT
            value: ${PRODUCT}          
        jenkinsfilePath: setup-environments/pipelines/promote-passive-to-live.jenkinsFile
      type: JenkinsPipeline
  status:
    lastVersion: 0             